# ğŸ¤ TCP 3 & 4 Way HandShake
---
## 1. ã€€3 & 4 Way HandShake ë€?
- ### í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì—°ê²°ì„±ë¦½ ë° ì—°ê²°í•´ì œë¥¼ í•˜ê¸°ìœ„í•´ ê±°ì¹˜ëŠ” ê³¼ì •

---

## 2. ã€€TCPì˜ ì—°ê²° ì„±ë¦½  
### `3 way handshake`  
- #### TCPëŠ” ì‹ ë¢°ì„±ì„ ìœ„í•´, ë…¼ë¦¬ì ì¸ ì ‘ì†ì„ ì„±ë¦½ì‹œí‚¤ê¸° ìœ„í•œ 3ë‹¨ê³„ì˜ ê³¼ì •ì„ ê±°ì¹œë‹¤
![](https://velog.velcdn.com/images/k-minsik/post/c2a651c4-714d-489e-9ae4-878042661b6d/image.png)

### 1. SYN : í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ê²Œ ìì‹ ì˜ ISNì„ ë‹´ì€ SYN íŒ¨í‚·ì„ ë³´ë‚¸ë‹¤  
### 2. SYN + ACK : SYNì„ ìˆ˜ì‹ í•œ ì„œë²„ëŠ” ì„œë²„ì˜ ISNì„ ë‹´ì€ SYNê³¼ ACK(client SYN + 1)ì„ ì‘ë‹µí•œë‹¤
### 3. ACK : ì„œë²„ì˜ ì‘ë‹µì„ ë°›ì€ í´ì•„ì´ì–¸íŠ¸ê°€ ACK(server SYN + 1)ì„ ì‘ë‹µí•œë‹¤  

- #### ìœ„ ì„¸ ë‹¨ê³„ë¥¼ ê±°ì³ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì—°ê²°ì´ ì„±ë¦½ëœë‹¤

> LISTEN : ì„œë²„ëŠ” CLOSED ìƒíƒœì—ì„œ ì„œë²„ê°€ ì—´ë¦° ìƒíƒœ ì¦‰ LISTEN ìƒíƒœì—¬ì•¼ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
> ISN : TCP ê¸°ë°˜ ë°ì´í„° í†µì‹ ì—ì„œ ê°ê°ì˜ ìƒˆ ì—°ê²°ì— í• ë‹¹ëœ ê³ ìœ í•œ 32bits Sequence num  
> SYN : synchronizationì˜ ì•½ì, ì—°ê²° ìš”ì²­ í”Œë˜ê·¸  
> ACK : acknowledgementì˜ ì•½ì, ì‘ë‹µ í”Œë˜ê·¸

---

## 3. ã€€TCPì˜ ì—°ê²° í•´ì œ  
### 4 way handshake
- #### ëª¨ë“  í†µì‹ ì´ ëë‚¬ë‹¤ë©´ ì—°ê²°ì„ í•´ì œí•˜ê¸° ìœ„í•´ 4ë‹¨ê³„ì˜ ê³¼ì •ì„ ê±°ì¹œë‹¤
![](https://velog.velcdn.com/images/k-minsik/post/65a4918f-7341-4b1c-bf76-50ce439e2dce/image.png)


### 1. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ê²Œ FIN ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë³´ë‚´ê³  FIN_WAIT_1 ìƒíƒœë¡œ ì„œë²„ì˜ ì‘ë‹µì„ ê¸°ë‹¤ë¦°ë‹¤
### 2. FINì„ ìˆ˜ì‹ í•œ ì„œë²„ê°€ ACK ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì‘ë‹µí•˜ê³  CLOSE_WAIT ìƒíƒœê°€ ëœë‹¤.
### ã€€ã€€ ACKë¥¼ ë°›ì€ í´ë¼ì´ì–¸íŠ¸ëŠ” FIN_WAIT_2 ìƒíƒœê°€ ëœë‹¤
### 3. ì„œë²„ëŠ” LAST_ACK ìƒíƒœê°€ ë˜ì—ˆë‹¤ê°€, ë°ì´í„°ë¥¼ ëª¨ë‘ ë³´ë‚¸ í›„ FIN ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë³´ë‚¸ë‹¤
### 4. FINì„ ìˆ˜ì‹ í•œ í´ë¼ì´ì–¸íŠ¸ê°€ ACKë¥¼ ì„œë²„ì—ê²Œ ì‘ë‹µí•˜ê³  TIME_WAITì˜ ìƒíƒœë¡œ ë‚¨ì€ ë°ì´í„°ë¥¼
### ã€€ã€€ê¸°ë‹¤ë¦¬ë‹¤ê°€ Closedê°€ ëœë‹¤. ê·¸ë¦¬ê³  ì„œë²„ëŠ” ACKë¥¼ ìˆ˜ì‹ í•œ ì¦‰ì‹œ Closedê°€ ëœë‹¤

ìœ„ ë„¤ ë‹¨ê³„ë¥¼ ê±°ì³ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì—°ê²°ì´ í•´ì œëœë‹¤
> TIME_WAIT : ì§€ì—° íŒ¨í‚· ë“±ì´ ë°œìƒí–ˆì„ ë•Œ ë°ì´í„° ë¬´ê²°ì„±ì„ ìœ„í•´ íŒ¨í‚·ì„ ê¸°ë‹¤ë¦¬ëŠ” ì‹œê°„. 2*MSL(ìµœëŒ€ íŒ¨í‚· ìˆ˜ëª…)

---

> ì´ë¯¸ì§€ ì¶œì²˜ : https://www.inflearn.com/course/%EA%B0%9C%EB%B0%9C%EC%9E%90-%EB%A9%B4%EC%A0%91-cs-%ED%8A%B9%EA%B0%95#
